<div class="profile-container">
  <div class="profile-header">
    <h2>โปรไฟล์ผู้ใช้</h2>
    <div class="header-actions">
      <button class="btn btn-secondary" (click)="goToWorkoutHistory()">
        ประวัติการออกกำลังกาย
      </button>
      <button class="btn btn-secondary" (click)="goToRegistrationHistory()">
        ประวัติการสมัคร
      </button>
      <button class="btn btn-danger" (click)="logout()">
        ออกจากระบบ
      </button>
    </div>
  </div>

  <div class="profile-content" *ngIf="currentUser">
    <div class="profile-card">
      <!-- Success/Error Messages -->
      <div class="success-message" *ngIf="successMessage">
        {{ successMessage }}
      </div>
      <div class="error-message" *ngIf="errorMessage">
        {{ errorMessage }}
      </div>

      <!-- View Mode -->
      <div *ngIf="!isEditing" class="profile-view">
        <div class="profile-avatar">
          <div class="avatar-circle">
            {{ currentUser.fullName.charAt(0).toUpperCase() }}
          </div>
        </div>

        <div class="profile-info">
          <div class="info-group">
            <label>ชื่อผู้ใช้:</label>
            <span>{{ currentUser.username }}</span>
          </div>

          <div class="info-group">
            <label>ชื่อ-นามสกุล:</label>
            <span>{{ currentUser.fullName }}</span>
          </div>

          <div class="info-group">
            <label>อีเมล:</label>
            <span>{{ currentUser.email }}</span>
          </div>

          <div class="info-group">
            <label>เบอร์โทรศัพท์:</label>
            <span>{{ currentUser.phone || 'ไม่ระบุ' }}</span>
          </div>

          <div class="info-group">
            <label>วันเกิด:</label>
            <span>{{ formatDate(currentUser.dateOfBirth) }}</span>
          </div>

          <div class="info-group">
            <label>เพศ:</label>
            <span>{{ getGenderDisplay(currentUser.gender) }}</span>
          </div>

          <div class="info-group">
            <label>วันที่สมัครสมาชิก:</label>
            <span>{{ formatDate(currentUser.registrationDate) }}</span>
          </div>
        </div>

        <div class="profile-actions">
          <button class="btn btn-primary" (click)="toggleEdit()">
            แก้ไขโปรไฟล์
          </button>
        </div>
      </div>

      <!-- Edit Mode -->
      <div *ngIf="isEditing" class="profile-edit">
        <form (ngSubmit)="saveProfile()" #profileForm="ngForm">
          <div class="form-group">
            <label for="fullName">ชื่อ-นามสกุล:</label>
            <input
              type="text"
              id="fullName"
              name="fullName"
              [(ngModel)]="editForm.fullName"
              required
              class="form-control"
            >
          </div>

          <div class="form-group">
            <label for="email">อีเมล:</label>
            <input
              type="email"
              id="email"
              name="email"
              [(ngModel)]="editForm.email"
              required
              class="form-control"
            >
          </div>

          <div class="form-group">
            <label for="phone">เบอร์โทรศัพท์:</label>
            <input
              type="tel"
              id="phone"
              name="phone"
              [(ngModel)]="editForm.phone"
              class="form-control"
            >
          </div>

          <div class="form-group">
            <label for="dateOfBirth">วันเกิด:</label>
            <input
              type="date"
              id="dateOfBirth"
              name="dateOfBirth"
              [(ngModel)]="editForm.dateOfBirth"
              class="form-control"
            >
          </div>

          <div class="form-group">
            <label for="gender">เพศ:</label>
            <select
              id="gender"
              name="gender"
              [(ngModel)]="editForm.gender"
              class="form-control"
            >
              <option value="">เลือกเพศ</option>
              <option value="male">ชาย</option>
              <option value="female">หญิง</option>
              <option value="other">อื่นๆ</option>
            </select>
          </div>

          <div class="form-actions">
            <button
              type="submit"
              [disabled]="isLoading"
              class="btn btn-primary"
            >
              <span *ngIf="isLoading">กำลังบันทึก...</span>
              <span *ngIf="!isLoading">บันทึก</span>
            </button>
            <button
              type="button"
              class="btn btn-secondary"
              (click)="toggleEdit()"
            >
              ยกเลิก
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
